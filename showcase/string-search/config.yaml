# OpenEvolve Configuration for String Search Evolution
# Optimized for discovering high-performance string search algorithms

# Evolution parameters
evolution:
  iterations: 200
  population_size: 50
  num_islands: 4          # Parallel populations for diversity
  migration_interval: 10  # Exchange best candidates every N iterations
  migration_rate: 0.1     # Fraction of population to migrate

# LLM ensemble configuration
llm:
  # Primary model for mutations
  primary:
    provider: anthropic
    model: claude-sonnet-4-20250514
    temperature: 0.7
    max_tokens: 4096

  # Secondary model for creative mutations
  secondary:
    provider: anthropic
    model: claude-sonnet-4-20250514
    temperature: 0.9
    max_tokens: 4096

  # Fast model for simple tweaks
  fast:
    provider: anthropic
    model: claude-haiku-4-20250514
    temperature: 0.3
    max_tokens: 2048

  # Ensemble weights
  ensemble_weights:
    primary: 0.5
    secondary: 0.3
    fast: 0.2

# Prompt configuration
prompts:
  system: |
    You are an expert algorithm designer specializing in string search algorithms.
    Your goal is to create the fastest possible string search implementation in Rust.

    Key optimization areas:
    - Preprocessing: Build efficient lookup tables
    - Skip logic: Maximize characters skipped on mismatch
    - Cache efficiency: Minimize memory access patterns
    - SIMD-friendly: Structure code for potential vectorization
    - Branch prediction: Minimize unpredictable branches

    Known techniques to consider:
    - Bad character rule (Boyer-Moore, Horspool)
    - Good suffix rule (Boyer-Moore)
    - Failure function (KMP)
    - Rolling hash (Rabin-Karp)
    - Two-way algorithm (glibc memmem)
    - SIMD scanning (memchr)
    - Bloom filters for multi-pattern

  mutation_prefix: |
    Improve this Rust string search algorithm. Focus on PERFORMANCE.
    The algorithm must:
    1. Implement the StringSearch trait
    2. Return all starting indices where pattern is found
    3. Handle edge cases (empty pattern, pattern longer than text)
    4. Be correct for overlapping matches

    Current implementation:

# Evaluation configuration
evaluation:
  timeout: 300            # Max seconds per evaluation
  cascade: true           # Stop early on compilation failure
  parallel_evaluations: 4 # Run multiple evaluations concurrently

# Quality-diversity configuration (MAP-Elites)
map_elites:
  enabled: true
  dimensions:
    - name: code_length
      min: 50
      max: 500
      bins: 10
    - name: preprocessing_complexity
      min: 0
      max: 100
      bins: 5

# Reproducibility
seed: 42

# Output configuration
output:
  save_all_programs: true
  save_interval: 10
  output_dir: .evolve/string-search

# Mutation strategies (weights for selection)
mutation_strategies:
  tweak: 0.25           # Small optimizations
  restructure: 0.15     # Algorithm changes
  crossover: 0.20       # Combine two solutions
  specialize: 0.10      # Optimize for common cases
  alien: 0.10           # Radically different approach
  simplify: 0.10        # Remove complexity
  simd_hint: 0.10       # Add SIMD-friendly patterns
